<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Sidescroller</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        canvas {
            display: block;
            margin: auto;
            background-color: skyblue;
        }
    </style>
</head>
<body>
    <section class="section">
        <div class="container">
            <canvas id="gameCanvas" width="800" height="400"></canvas>
            <div id="scores" class="mt-4">
                <p id="scorePlayer1">Player 1 Score: 0</p>
                <a id="changeCharacter1" class="button is-primary">Change Character</a>
                <button class="button is-primary generateCharacterButton" data-player="1">Generate Character</button>
                <p id="scorePlayer2">Player 2 Score: 0</p>
                <a id="changeCharacter2" class="button is-primary">Change Character</a>
                <button class="button is-primary generateCharacterButton" data-player="2">Generate Character</button>

            </div>
            <br>
            <div class="field has-addons">
                <div class="control is-expanded">
                    <input type="text"  id="levelDescription" value="jungle temple ruins overgrown with vines and ferns, shafts of light" class="input">
                </div>
                <div class="control">
                    <button id="downloadButton" class="button is-link">Generate</button>
                </div>
            </div>
            <div class="progress is-small" id="progressContainer" display="None">
                <progress class="progress is-primary" value="0" id="progressBar" max="100">0%</progress>
            </div>
            <button id="editButton" class="button is-info mt-4">Edit Map</button>
    
            <div id="edit-tools" style="display: none;">
                <label class="checkbox">
                    <input type="checkbox" id="architectureToggle" name="architectureToggle" checked>
                    Toggle Architecture
                </label>
                
                <div class="field">
                    <input type="range" id="bgSlider" min="0" max="255" value="0" class="slider">
                    <label for="bgSlider">Background Brightness</label>
                </div>
                
                <label class="checkbox">
                    <input type="checkbox" id="gradientCheckbox" name="gradientCheckbox">
                    Use Gradient
                </label>
                <br>
                
                <label class="checkbox">
                    <input type="checkbox" id="jaggyCheckbox" name="jaggyCheckbox">
                    Rough Edges
                </label>
                
                <div id="jaggyControls" style="display: none;">
                    <div class="field">
                        <label for="sections">Roughness number of sections</label>
                        <input type="range" id="sections" name="sections" min="2" max="8" class="slider">
                        <span id="sections-value"></span>
                    </div>
                    <div class="field">
                        <label for="deviation">Roughness Size</label>
                        <input type="range" id="deviation" name="deviation" min="0" max="15" class="slider">
                        <span id="deviation-value"></span>
                    </div>
                </div> 
                <br>
                <button id="clearButton" class="button is-warning">Clear All</button>
                <button id="fillButton" class="button is-primary">Fill All</button>
            </div>

            <pre id="mapDisplay"></pre>
        </div>
        <div class="modal" id="generateCharacterModal">
            <div class="modal-background"></div>
            <div class="modal-card">
              <header class="modal-card-head">
                <p class="modal-card-title">Generate New Character</p>
                <button class="delete" aria-label="close" id="closeModal"></button>
              </header>
              <section class="modal-card-body">
                <!-- Content -->
                <form id="characterForm">
                  <div class="field">
                    <label class="label" for="characterDescription">Description</label>
                    <div class="control">
                      <input class="input" type="text" id="characterDescription" name="characterDescription" value="a person">
                    </div>
                    <p class="help">Note: this model takes prompts as very loose suggestions, and ignores things it doesn't understand</p>
                  </div>
                </form>
              </section>
              <footer class="modal-card-foot">
                <button class="button is-success" id="submitCharacter">Submit</button>
                <button class="button" id="cancelCharacter">Cancel</button>
              </footer>
            </div>
          </div>
    </section>
    <script src="https://cdn.socket.io/4.3.2/socket.io.min.js" crossorigin="anonymous"></script>
    <script src="sidescroller.js"></script>
</body>
